<wxs src="WXS/base.wxs" module="Utils" />

<block wx:if="{{type === 'textarea'}}">
    <!-- 自动换行 -->
    <view class="oak-field-textarea {{maxlength > 0 ? 'maxlength' : ''}} ext-class">
        <textarea
            class="input-class"
            value="{{value}}"
            placeholder="{{placeholder}}"
            placeholder-style="{{placeholderStyle}}"
            placeholder-class="input-placeholder"
            disabled="{{disabled}}"
            maxlength="{{maxlength}}"
            auto-height="{{autoHeight}}"
            confirm-type="{{confirmType}}"
            confirm-hold="{{confirmHold}}"
            focus="{{focus}}"
            fixed="{{fixed}}"
            cursor-spacing="{{cursorSpacing}}"
            cursor="{{cursor}}"
            selection-start="{{selectionStart}}"
            selection-end="{{selectionEnd}}"
            adjust-position="{{adjustPosition}}"
            hold-keyboard="{{holdKeyboard}}"
            bindfocus="focus"
            bindblur="blur"
            bindinput="change"
            bindconfirm="confirm"
            bindkeyboardheightchange="keyboardheightchange"
        ></textarea>
        <view class="max-length {{!value.length ? 'default' : ''}}" wx:if="{{maxlength > 0}}">{{value.length}}/{{maxlength}}</view>
    </view>
</block>
<block wx:elif="{{type === 'captcha-b'}}">
    <!-- input -->
    <view class="field-captcha-b ext-class">
        <input class="captcha-b-input input-class"
            style="word-spacing: 57px;"
            type="{{type === 'password' ? 'text' : type}}"
            placeholder="{{placeholder}}"
            disabled="{{disabled}}"
            password="{{type === 'password' && seePasswordType === 0}}"
            placeholder-style="{{placeholderStyle}}"
            placeholder-class="input-placeholder"
            focus="{{focus}}"
            confirm-type="{{confirmType}}"
            confirm-hold="{{confirmHold}}"
            cursor="{{cursor}}"
            selection-start="{{selectionStart}}"
            selection-end="{{selectionEnd}}"
            adjust-position="{{adjustPosition}}"
            hold-keyboard="{{holdkeyboard}}"
            maxlength="{{maxlength}}"
            cursor-spacing="{{cursorSpacing}}"
            catchfocus="focus"
            bindinput="change"
            bindblur="blur"
            bindconfirm="confirm"
            bindkeyboardheightchange="keyboardheightchange"
        />
        <!-- input 设置letter-spacing 不生效 -->
        <view class="captcha-line">
            <text class="line {{focused && value.length == 0 ? 'active' : ''}}">{{value[0] || ''}}</text>
            <text class="line {{focused && value.length == 1 ? 'active' : ''}}">{{value[1] || ''}}</text>
            <text class="line {{focused && value.length == 2 ? 'active' : ''}}">{{value[2] || ''}}</text>
            <text class="line {{focused && value.length == 3 ? 'active' : ''}}">{{value[3] || ''}}</text>
            <text class="line {{focused && value.length == 4 ? 'active' : ''}}">{{value[4] || ''}}</text>
            <text class="line {{focused && (value.length == 5 || value.length == 6) ? 'active' : ''}}">{{value[5] || ''}}</text>
        </view>
    </view>
</block>
<block wx:else>
    <!-- input -->
    <view class="oak-field ext-class">
        <input class="input-class input {{ellipsis ? 'ellipsis' : ''}}"
            value="{{value}}"
            type="{{type === 'password' ? 'text' : type}}"
            placeholder="{{placeholder}}"
            disabled="{{disabled}}"
            password="{{type === 'password' && seePasswordType === 0}}"
            placeholder-style="{{placeholderStyle}}"
            placeholder-class="input-placeholder"
            focus="{{focus}}"
            confirm-type="{{confirmType}}"
            confirm-hold="{{confirmHold}}"
            cursor="{{cursor}}"
            selection-start="{{selectionStart}}"
            selection-end="{{selectionEnd}}"
            adjust-position="{{adjustPosition}}"
            hold-keyboard="{{holdkeyboard}}"
            maxlength="{{maxlength}}"
            cursor-spacing="{{cursorSpacing}}"
            bindfocus="focus"
            bindinput="change"
            bindblur="blur"
            bindconfirm="confirm"
            bindkeyboardheightchange="keyboardheightchange"
        />
        <!-- 清空icon -->
        <oak-icon 
            wx:if="{{clearable && focused && value}}"
            class="oak-field-clear"
            name="close-facet" 
            color="{{clearIconColor}}"
            size="34rpx"
            bindtap="clear" 
        ></oak-icon>
        <!-- 密码切换明文密文icon -->
        <oak-icon 
            wx:if="{{type === 'password' && selectPasswordVisiable}}"
            class="oak-field-clear"
            name="{{seePasswordType ? 'openeyes' : 'closeeyes'}}" 
            color="{{passwordIconColor}}"
            size="34rpx"
            bindtap="selectSeePasswordType" 
        ></oak-icon>
        <view wx:if="{{type === 'captcha-a'}}" class="captcha {{countDownTime < 1 ? 'active' : ''}} captcha-class" catchtap="getCaptcha">{{countDownTime > 0 ? '重新发送(' + countDownTime + ')' : '发送验证码'}}</view>
        <slot />
    </view>
</block>
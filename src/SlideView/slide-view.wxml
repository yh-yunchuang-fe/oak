<wxs src="WXS/base.wxs" module="Utils" />

<wxs module="SlideUtil">
    function offsetX(share, edit, collect, del, offsetX, singleWidth, index) {
        singleWidth = singleWidth + 0
        var buttons = [share, edit, collect, del]
        var idx = []
        for(var i = 0; i < buttons.length; i++) {
            if(buttons[i] === true) idx.push(i)
        }
        if(idx.length === 1) return offsetX + singleWidth
        if(idx.length === 2) {
            if(idx[0] === index) return offsetX + singleWidth
            return offsetX / 2 + singleWidth
        }
        if(idx.length === 3) {
            if(idx[0] === index) return offsetX + singleWidth
            if(idx[1] === index) return offsetX / 3 * 2 + singleWidth
            return offsetX / 3 * 1 + singleWidth
        }
        if(idx.length === 4) {
            if(idx[0] === index) return offsetX + singleWidth
            if(idx[1] === index) return offsetX / 4 * 3 + singleWidth
            if(idx[2] === index) return offsetX / 2 * 1 + singleWidth
            return offsetX / 4 * 1 + singleWidth
        }
    }
    module.exports = { offsetX: offsetX }
</wxs>

<view class="oak-slide-view ext-class">
    <view 
        class="slide" 
        bind:touchstart="touchstart"
        bind:touchmove="touchmove"
        bind:touchcancel="touchcancel"
        bind:touchend="touchend"
        style="transform:translateX({{offsetX}}px);{{transition}}">
        <view class="left"><slot name="left"/></view>
        <view wx:if="{{custom}}" class="right" style="width: {{singleWidth}}px;">
            <slot name="right" />
        </view>
    </view>
    <block wx:if="{{type === 'text' && !custom}}">
        <view wx:if="{{share}}"
            class="item share share-class"
            catch:tap="onShare" 
            style="width:{{singleWidth}}px;transform:translateX({{SlideUtil.offsetX(share, edit, collect, del, offsetX, singleWidth, 0)}}px);{{transition}}">{{shareText}}</view>
        <view wx:if="{{edit}}"
            catch:tap="onEdit"
            class="item edit edit-class"
            style="width:{{singleWidth}}px;transform:translateX({{SlideUtil.offsetX(share, edit, collect, del, offsetX, singleWidth, 1)}}px);{{transition}}">{{editText}}</view>
        <view wx:if="{{collect}}"
            catch:tap="onCollect" 
            class="item collect collect-class" 
            style="width:{{singleWidth}}px;transform:translateX({{SlideUtil.offsetX(share, edit, collect, del, offsetX, singleWidth, 2)}}px);{{transition}}">{{collectText}}</view>
        <view wx:if="{{del}}"
            class="item delete delete-class" 
            catch:tap="onDelete" 
            style="width:{{singleWidth}}px;transform:translateX({{SlideUtil.offsetX(share, edit, collect, del, offsetX, singleWidth, 3)}}px);{{transition}}">{{delText}}</view>
    </block>
    <block wx:elif="{{type === 'icon' && !custom}}">
        <view wx:if="{{share}}"
            class="item"
            catch:tap="onShare" 
            style="width:{{singleWidth}}px;transform:translateX({{SlideUtil.offsetX(share, edit, collect, del, offsetX, singleWidth, 0)}}px);{{transition}}">
            <view class="icon icon-class"><slot name="share" /></view>
        </view>
        <view wx:if="{{edit}}"
            class="item"
            catch:tap="onEdit" 
            style="width:{{singleWidth}}px;transform:translateX({{SlideUtil.offsetX(share, edit, collect, del, offsetX, singleWidth, 1)}}px);{{transition}}">
            <view class="icon icon-class"><slot name="edit" /></view>
        </view>
        <view wx:if="{{collect}}"
            class="item"
            catch:tap="onCollect" 
            style="width:{{singleWidth}}px;width: ;transform:translateX({{SlideUtil.offsetX(share, edit, collect, del, offsetX, singleWidth, 2)}}px);{{transition}}">
            <view class="icon icon-class"><slot name="edit" /></view>
        </view>
        <view wx:if="{{del}}"
            class="item"
            catch:tap="onDelete" 
            style="width:{{singleWidth}}px;transform:translateX({{SlideUtil.offsetX(share, edit, collect, del, offsetX, singleWidth, 3)}}px);{{transition}}">
            <view class="icon icon-class"><slot name="delete" /></view>
        </view>
    </block>
</view>